PUT _index_template/tosca-system-info-template
{
  "index_patterns": ["tosca-system-info-*"],
  "priority": 10,
  "template": {
    "mappings": {
      "dynamic": true,
      "date_detection": true,
      "numeric_detection": true,
      "dynamic_templates": [
        {
          "properties_as_keywords": {
            "path_match": "*properties.name",
            "mapping": {
              "type": "keyword",
              "ignore_above": 512
            }
          }
        },
        {
          "properties_values_as_keywords": {
            "path_match": "*properties.value",
            "mapping": {
              "type": "keyword",
              "ignore_above": 512
            }
          }
        },
        {
          "uniqueids_as_keywords": {
            "path_match": "*unique-id*",
            "mapping": {
              "type": "keyword"
            }
          }
        },
        {
          "parent_surrogate_as_keywords": {
            "path_match": "*parent-surrogate-num*",
            "mapping": {
              "type": "keyword"
            }
          }
        },
        {
          "date_matches": {
            "path_match": "*start-time|*end-time|*created-at|*modified-at",
            "mapping": {
              "type": "date"
            }
          }
        },
        {
          "strings": {
            "match_mapping_type": "string",
            "mapping": {
              "type": "keyword",
              "ignore_above": 512
            }
          }
        }
      ],
      "properties": {
        "@timestamp": { "type": "date" },
        "@version": { "type": "long" },
        "timestamp": { "type": "date" },
        "start-time": { "type": "date" },
        "end-time": { "type": "date" },
        "eventtime": { "type": "date" },
        "action": { "type": "keyword", "ignore_above": 512 },
        "script": { "type": "keyword", "ignore_above": 512 },
        "description": { "type": "text" },
        "aggregated-description": { "type": "text" },
        "log-info": { "type": "text" },
        "tags": { "type": "keyword" },
        "index_prefix": { "type": "keyword" },
        "name": { "type": "keyword" },
        "product": { "type": "keyword", "ignore_above": 512 },
        "cust-code": { "type": "keyword", "ignore_above": 512 },
        "country": { "type": "keyword", "ignore_above": 512 },
        "agent": {
          "properties": {
            "ephemeral_id": { "type": "keyword", "ignore_above": 512 },
            "id": { "type": "keyword", "ignore_above": 512 },
            "name": { "type": "keyword", "ignore_above": 512 },
            "type": { "type": "keyword", "ignore_above": 512 },
            "version": { "type": "keyword", "ignore_above": 512 }
          }
        },
        "ecs": {
          "properties": {
            "version": { "type": "keyword", "ignore_above": 512 }
          }
        },
        "computer-system": {
          "properties": {
            "manufacturer": { "type": "keyword", "ignore_above": 512 },
            "model": { "type": "keyword", "ignore_above": 512 },
            "number-of-logical-processors": { "type": "long" },
            "number-of-processors": { "type": "long" },
            "total-physical-memory": { "type": "long" }
          }
        },
        "cpu": {
          "properties": {
            "name": { "type": "keyword", "ignore_above": 512 },
            "max-clock-speed": { "type": "long" },
            "current-clock-speed": { "type": "long" },
            "load-percentage": { "type": "long" }
          }
        },
        "memory": {
          "properties": {
            "available-ram-mb": { "type": "float" },
            "used-ram-gb": { "type": "float" },
            "total-ram-gb": { "type": "float" },
            "percent-used": { "type": "long" }
          }
        },
        "disk": {
          "properties": {
            "device-id": { "type": "keyword", "ignore_above": 512 },
            "size-gb": { "type": "float" },
            "free-space-gb": { "type": "float" },
            "used-space-gb": { "type": "float" },
            "percent-used": { "type": "float" }
          }
        },
        "log": {
          "properties": {
            "offset": { "type": "long" },
            "file": {
              "properties": {
                "path": { "type": "keyword", "ignore_above": 512 },
                "fingerprint": { "type": "keyword", "ignore_above": 512 },
                "idxhi": { "type": "long" },
                "idxlo": { "type": "long" },
                "vol": { "type": "long" }
              }
            }
          }
        },
        "folder": {
          "type": "text",
          "fields": {
            "raw": { "type": "keyword", "ignore_above": 2048 }
          }
        }
      }
    }
  }
}